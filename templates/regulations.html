{% extends "base.html" %}

{% block title %}League Regulations - Tennis Ratings{% endblock %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <h1 class="mb-4">Регламент лиги</h1>

            <!-- Table of Contents -->
            <div class="card mb-4">
                <div class="card-header bg-secondary text-white">
                    <h5 class="mb-0">Оглавление</h5>
                </div>
                <div class="card-body">
                    <ol class="mb-0">
                        <li><a href="#section1">Общие положения</a></li>
                        <li><a href="#section2">Регламент матча</a></li>
                        <li><a href="#section3">Окончание сезона</a></li>
                        <li><a href="#section4">Допуск участников и регистрация</a></li>
                    </ol>
                </div>
            </div>

            <!-- Section 1: League Structure -->
            <section id="section1" class="mb-5">
                <div class="card">
                    <div class="card-header bg-light">
                        <h3 class="mb-0">1. Общие положения</h3>
                    </div>
                    <div class="card-body">
                        <h5>1.1 Сезоны</h5>
                        <ul>
                            <li>Лига состоит из сезонов, фиксированной длительности (обычно от 1 до 2 месяцев).</li>
                            <li>Учитываются только игры сыгранные в период, зафиксированный в регламенте сезона, могут остаться оппоненты с которыми не успеете сыграть.</li>
                            <li>Размер взноса, сроки сезона, количество призов, призовые места и правила переходов фиксируются в регламенте сезона.</li>
                            <li>По итогам сезона происходит награждение призами и перераспределение участников по дивизионам.</li>
                        </ul>

                        <h5>1.2 Дивизионы</h5>
                        <ul>
                            <li>Лига разделена на дивизионы, отражающие результаты предыдущих сезонов.</li>
                            <li>За время сезона каждый участник играем с каждым в рамках своего дивизиона.</li>
                            <li>Размер дивизиона может варьироваться, но не должен превышать 10-12 человек, чтобы у участников была возможность сыграть все матчи</li>
                            <li>Дивизионы M1, M2 и т.д. соответствуют категории Masters. Увеличение порядкового номера соответствует более слабым дивизионам.</li>
                            <li>O1, O2 - категория Open (более слабый уровень).</li>
                        </ul>

                        <h5>1.3 Организация</h5>
                        <ul>
                            <li>Организация сезонов (назначенные матчи, результаты игр, актуальная таблица) в приложении Raketo.</li>
                            <li>На время сезона создается телеграмм чат для поиска оппонентов и согласования времени матчей.</li>
                            <li>Участники самостоятельно выбирают порядок оппонентов, напрямую договариваются об удобном времени и месте матчей, фиксируют результаты в приложении.</li>
                            <li>Лига не обеспечивает корты или мячи.</li>
                        </ul>

                    </div>
                </div>
            </section>

            <!-- Section 2: Match Rules -->
            <section id="section2" class="mb-5">
                <div class="card">
                    <div class="card-header bg-light">
                        <h3 class="mb-0">2. Регламент матча</h3>
                    </div>
                    <div class="card-body">
                        <h5>2.1 Masters</h5>
                        <ul>
                            <li>Матч до двух выигранных сетов.</li>
                            <li>Полный гейм - при счете ровно играется до разницы в два очка.</li>
                            <li>Тайбрейк до 7 очков (с разницей не менее двух очков) при счете в сете 6-6.</li>
                            <li>Тайбрейк до 10 очков (с разницей не менее двух очков) вместо третьего сета, в случае равенства 1-1 по сетам.</li>
                            <li>Допускается полный третий сет в случае согласия обоих участников.</li>
                            <li>Рекомендуемое время бронирования корта - 2 часа.</li>
                        </ul>
                        <h5>2.2 Open</h5>
                        <ul>
                            <li>Матч в один проф. сет до 8 выигранных геймов.</li>
                            <li>Полный гейм - при счете ровно играется до разницы в два очка.</li>
                            <li>Тайбрейк до 7 очков (с разницей не менее двух очков) при счете в сете 8-8.</li>
                            <li>Рекомендуемое время бронирования корта - 1 час.</li>
                            <li>Допускается использование формата Masters при обоюдном согласии до начала матча.</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 3: Rating System -->
            <section id="section3" class="mb-5">
                <div class="card">
                    <div class="card-header bg-light">
                        <h3 class="mb-0">3. Окончание сезона</h3>
                    </div>
                    <div class="card-body">
                        <h5>3.1 Определение мест</h5>
                        <p>Для определения мест в дивизионе сравниваются:</p>
                        <ol>
                            <li>Количество очков (побед),</li>
                            <li>Количество побед в очных играх между игроками с равным количеством очков,</li>
                            <li>Общее количество игр (чем больше тем выше),</li>
                            <li>Разница сетов,</li>
                            <li>Разница геймов,</li>
                            <li>При полном равенстве показателей - случайный жребий.</li>
                        </ol>
                        <p><i>(Каждый следующий пункт после первого используется только в случае равенства по предыдущим)</i></p>

                        <h5>3.2 Призеры</h5>
                        <ul>
                            <li>Каждый дивизион имеет фиксированное количество призовых мест.</li>
                            <li>Призовые места и размер приза фиксируются в регламенте сезона.</li>
                            <li>Призы за активное участие: <ul>
                                <li>Разыгрываются случайным образом между участниками всех дивизионов, сыгравших 7 или более игр за сезон, не занявших призового места. </li>
                                <li>Если количество игроков с 7+ матчами менее или равно количеству призов, то все игроки с 7+ матчами получают приз, а остальные призы разыгрываются между игроками с 6 матчами (и далее с уменьшением количества, пока остаются призы).</li>
                            </ul>
                            </li>
                        </ul>

                        <h5>3.3 Переходы</h5>
                        <ul>
                            <li>По итогам сезона игроки занявшие лучшие места в своем дивизионе переходят в дивизион выше, худшие - в дивизион ниже</li>
                            <li>Точное количество переходов фиксируется в регламенте сезона.</li>
                            <li>Правило раннего перехода (опциональное правило для продолжительных сезонов): по итогам половины сезона первое место может досрочно перейти в дивизион выше. <ul>
                                <li>При переходе в дивизион выше сгорают все набранные очки. Но матчи учитываются для определения приза за активность.</li>
                                <li>Игры в старом дивизионе не доигрываются. Ранее сыгранные матчи остаются в зачете соперникам.</li>
                                <li>Переходы по итогам сезона определяются по результатам в новой группе (возможен переход обратно).</li>
                            </ul> </li>
                            <li>Участники с 0 побед в сезоне понижаются в дивизионе вне зависимости от фактически занимаемого места.</li>
                        </ul>

                        <h5>3.4 Рейтинг</h5>
                        <ul>
                            <ul>
                                <li>Рейтинг лиги обновляется по итогам рейтинговых сезонов.</li>
                                <li>Учитываются только последний сезон, сыгранный играком, при условии, что с его окончания сезона прошло не более 1 года.</li>
                                <li>Рейтинг определяется сортировкой по следующим параметрам:<ol>
                                    <li>Дивизион по итогам переходов.</li>
                                    <li>Предыдущий дивизион (игроки перешедшие вверх всегда ниже игроков, удержавшихся в дивизионе)</li>
                                    <li>Итоговое место в дивизионе.</li>
                                    <li>Давность сезона (более свежие результаты имеют приоритет).</li>
                                </ol>
                                </li>
                                <li>Актуальный рейтинг используется для распределения Wild card в случае недобора участников в дивизионы.</li>
                            </ul>
                        </ul>
                    </div>
                </div>
            </section>



            <!-- Section 4: Player Eligibility -->
            <section id="section4" class="mb-5">
                <div class="card">
                    <div class="card-header bg-light">
                        <h3 class="mb-0">4. Допуск участников и регистрация</h3>
                    </div>
                    <div class="card-body">
                        <h5>4.1 Допуск к лиге</h5>
                        <ul>
                            <li>К участию допускаются игроки любого уровня.</li>
                            <li>Минимальный возраст для участия в лиге - 16 лет.</li>
                            <li>Регистрируясь в лигу, игрок подтверждает свою доступность в Ташкенте в течение сезона (не менее 50% периода).</li>
                            <li>Регистрация на сезон начинается за неделю до старта сезона.</li>
                            <li>Возможна поздняя регистрация в начатый сезон, крайняя дата поздней регистрации фиксируется в регламенте сезона.</li>
                        </ul>
                        <h5>4.2 Допуск к дивизионам</h5>
                        <ul>
                            <li>Дивизион участника определяется по итогам предыдущих выступлений в лиге.</li>
                            <li>Для новых игроков возможна выдача организатором Wild Card по запросу участника.</li>
                            <li>Возможные основания для выдачи WC: <ol>
                                <li>Победители турнирных матчей (любых организаторов) против игроков уровня соответствующего дивизиона (за период последнего сезона).</li>
                                <li>С соответствующим рейтингом Raketo (при условии калибровки и наличия игр за период последнего сезона против других участников лиги).</li>
                                <li>Профессиональный или тренерский статус участника.</li>
                            </ol></li>
                            <li>Стартовый дивизион участников, ранее не участвовавших в лиге, определяется организатором, исходя из результатов доступных матчей.</li>
                            <li>При регистрации на новый сезон возможно понижение дивизиона по желанию, при согласовании с организатором.</li>
                        </ul>

                        <h5>4.3 Порядок регистрации</h5>
                        <ol>
                            <li>Зарегистрироваться в приложении Raketo.</li>
                            <li>Заявиться в соответствующий сезон.</li>
                            <li>Оплатить взнос (сумма и порядок оплаты в регламенте сезона).</li>
                            <li>Прислать подтверждение оплаты организатору личным сообщением, указав имя и фамилию в приложении.</li>
                            <li>Возможно присоединиться к сезону по ходу (крайняя дата регистрации фиксируется в регламенте сезона).</li>
                        </ol>


                    </div>
                </div>
            </section>

        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Smooth scrolling for table of contents links
document.addEventListener('DOMContentLoaded', function() {
    const links = document.querySelectorAll('a[href^="#"]');

    links.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // Highlight current section in view
    const sections = document.querySelectorAll('section');
    const navLinks = document.querySelectorAll('.card-body ol li a');

    window.addEventListener('scroll', function() {
        let current = '';

        sections.forEach(section => {
            const sectionTop = section.offsetTop;
            const sectionHeight = section.clientHeight;

            if (pageYOffset >= sectionTop - 100) {
                current = section.getAttribute('id');
            }
        });

        navLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === '#' + current) {
                link.classList.add('active');
                link.style.fontWeight = 'bold';
            }
        });
    });
});
</script>
{% endblock %}